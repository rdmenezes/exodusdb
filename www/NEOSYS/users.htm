<html>
<head>

    <script>
		    var gmodule='GENERAL'
			var gdatafilename='USERS'
			var gupdateonlymode=true
    </script>

    <script language="javascript" src="../neosys/scripts/client.js"></script>

    <script language="javascript" src="../general/scripts/general.js"></script>

    <script language="javascript" src="../neosys/scripts/authorisation2.js"></script>

    <script language="javascript" src="../neosys/scripts/colors.js"></script>

    <script>

function users_val_screencolor()
{
 if (!neosys_val_color()) return neosysinvalid()
 neosys_set_style('screencolor',gvalue)
 return true
}

function users_val_screenfont()
{
 if (!neosys_val_font()) return neosysinvalid()
 neosys_set_style('screenfont',gvalue,gds.calcx('SCREEN_FONT_SIZE'))
 return true
}

function users_val_screenfontsize()
{
 neosys_set_style('screenfont',gds.calcx('SCREEN_FONT'),gvalue)
 return true
}

function form_postinit()
{
 //window.setTimeout("focuson('FIRST_CHEQUE_NO')",100)
 neosyssetexpression('button_password','disabled','!gusers_authorisation_update&&gkey!=gusername')
 
 //force retrieval of own record even if 
 window.setTimeout('focuson("USER_NAME")',100)
 
 gwhatsnew=neosysgetcookie(glogincode,'NEOSYS2','wn').toLowerCase()
 if (gwhatsnew)
 {
  if (window.location.href.toString().slice(0,5)=='file:') gwhatsnew='file:///'+gwhatsnew
  else gwhatsnew='..'+gwhatsnew.slice(gwhatsnew.indexOf('\\data\\'))
  neosyssetcookie(glogincode,'NEOSYS2','','wn')
  neosyssetcookie(glogincode,'NEOSYS2',gwhatsnew,'wn2')
  window.setTimeout('windowopen(gwhatsnew)',1000)
  //windowopen(gwhatsnew)
 }
 
 return true
 
}

//just to avoid confirmation			
function form_prewrite()
{
 return true
}

//in authorisation.js and users.htm
var gtasks_newpassword
function form_postwrite()
{

 //if change own password then login with the new one
 //otherwise cannot continue/unlock document so the lock hangs
 if (gtasks_newpassword) db.login(gusername,gtasks_newpassword)
 gtasks_newpassword=false
  
 //to avoid need full login to get new font/colors
 neosyssetcookie(glogincode,'NEOSYS2',gds.calcx('SCREEN_BODY_COLOR'),'fc')
 neosyssetcookie(glogincode,'NEOSYS2',gds.calcx('SCREEN_FONT'),'ff')
 neosyssetcookie(glogincode,'NEOSYS2',gds.calcx('SCREEN_FONT_SIZE'),'fs')

 return true
 
}

function users_postdisplay()
{
 //show only first five lines
 form_filter('refilter','LOGIN_DATE','',4)
 return true
}

function form_postread()
{
 window.setTimeout('users_postdisplay()',10)
 return true
}

    </script>

    <title>User Details</title>
</head>
<body>
    <div align="center">
        <h1>
            User Details</h1>
        <table class="neosystable" border="1">
            <thead>
            </thead>
            <tbody>
                <tr>
                    <td>
                        User Code</td>
                    <td colspan="4">
                        <input datafld="USER_ID">
                        <input neosysgroup="0" id="button_password" title="Change the password" class="neosysbutton" type="button"
                            neosystype="B" tabindex="999" value="Change password" onclick="user_setpassword(true)">
                    </td>
                </tr>
                <tr>
                    <td>
                        User Name</td>
                    <td colspan="4">
                        <input datafld="USER_NAME"></td>
                </tr>
                <tr>
                    <td>
                        Department</td>
                    <td colspan="4">
                        <input datafld="DEPARTMENT"></td>
                </tr>
                <tr>
                    <td>
                        Email Address</td>
                    <td colspan="4">
                        <input datafld="EMAIL_ADDRESS"></td>
                </tr>
                <tr>
                    <td>
                        Preferences
                    </td>
                    <th>
                        Font name</th>
                    <th>
                        Font size</th>
                    <th>
                        Body color</th>
                    <th>
                        Heading color</th>
                </tr>
                <tr>
                    <td align="right">
                        Screens:</td>
                    <td>
                        <input datafld="SCREEN_FONT" /></td>
                    <td>
                        <input datafld="SCREEN_FONT_SIZE" /></td>
                    <td>
                        <input datafld="SCREEN_BODY_COLOR" />
                    </td>
                    <td>
                        &nbsp;</td>
                </tr>
                <tr>
                    <td align="right">
                        Reports:</td>
                    <td>
                        <input datafld="REPORT_FONT" /></td>
                    <td>
                        &nbsp;</td>
                    <td>
                        <input datafld="REPORT_BODY_COLOR" /></td>
                    <td>
                        <input datafld="REPORT_HEAD_COLOR" />
                    </td>
                </tr>
                <tr>
                    <td colspan="5">
                        <table width="1%">
                            <thead>
                                <tr>
                                </tr>
                                <tr>
                                    <th colspan="3">
                                        Last login attempts:</th>
                                </tr>
                                <tr>
                                    <th id="LOGIN_DATE_title">
                                        Date</th>
                                    <th id="LOGIN_TIME_title">
                                        Time</th>
                                    <th id="LOGIN_LOCATION_title">
                                        Location</th>
                                    <th id="LOGIN_RESULT_title" width="200%">
                                        Result</th>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>
                                        <input datafld="LOGIN_DATE" /></td>
                                    <td>
                                        <input datafld="LOGIN_TIME" /></td>
                                    <td>
                                        <input datafld="LOGIN_LOCATION" /></td>
                                    <td>
                                        <input datafld="LOGIN_RESULT" /></td>
                                </tr>
                            </tbody>
                        </table>
                    </td>
                </tr>
        </table>
        </td> </tr> </tbody> </table>
    </div>
</body>
</html>
